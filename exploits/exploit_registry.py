from typing import Dict, Optional
from exploits.base_exploit import BaseExploit
from exploits.sqli_exploit import SQLiExploit


class ExploitRegistry:
    """Registry for managing exploits"""
    
    def __init__(self):
        self.exploits: Dict[str, BaseExploit] = {}
        self._register_default_exploits()
    
    def _register_default_exploits(self):
        """Register built-in exploits"""
        self.register('sqli', SQLiExploit())
        # TODO: Add more exploits
        # self.register('xss', XSSExploit())
    
    def register(self, vuln_type: str, exploit: BaseExploit):
        """Register an exploit for a vulnerability type"""
        self.exploits[vuln_type] = exploit
    
    def get_exploit(self, vuln_type: str) -> Optional[BaseExploit]:
        """Get exploit for a vulnerability type"""
        return self.exploits.get(vuln_type)
