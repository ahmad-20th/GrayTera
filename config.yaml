# GrayTera Configuration

subdomain_enum:
  timeout: 10
  max_subdomains: 1000
  
  # Enable/disable enumeration strategies
  use_dns: true
  use_crt_sh: true
  use_dorking: false
  
  # DNS enumeration settings
  dns:
    threads: 10
    wordlist: wordlists/subdomains.txt
  
  # Certificate Transparency settings
  ct:
    timeout: 20
  
  # Google dorking settings
  dork:
    pages: 5
    timeout: 10
  
  # Common subdomains to always check
  common_subdomains: ['www', 'mail', 'ftp', 'admin', 'blog', 'dev', 'api']

scope_filtering:
  enabled: true
  # Scope file can be specified via --scope argument
  # Example: python main.py example.com --scope scope.json

vulnerability_scan:
  threads: 10
  timeout: 30
  max_depth: 3
  follow_redirects: true
  
  # SQL Injection scanner
  sqli:
    enabled: true
    payloads_file: payloads/sqli_strategies.yaml
    detect_waf: true
  
  # XSS scanner (not yet implemented)
  xss:
    enabled: false
  
  # CSRF scanner (not yet implemented)
  csrf:
    enabled: false
  
  # OWASP ZAP integration
  zap:
    enabled: true
    api_key: '40lq05t4hqilu3n67or858443q'
    proxy_url: 'http://127.0.0.1:8080'
    spider_enabled: true
    active_scan_enabled: true
    max_depth: 2
    max_children: 5

  # Nikto scanner integration
  nikto:
    enabled: true
    nikto_path: null  # null = auto-detect from PATH
    timeout: 300

exploitation:
  auto_exploit: false  # Require manual confirmation for safety
  max_attempts: 3
  timeout: 60
  
  # SQLMap integration
  sqlmap:
    path: null  # null = auto-detect from PATH, or set absolute path
    level: 5    # 1-5 (detection depth)
    risk: 3     # 1-3 (test aggressiveness)
    threads: 10
    timeout: 600  # 10 minutes
    crawl_depth: 3
  
  # SQLi exploitation settings
  sqli:
    extract_tables: true
    extract_users: false  # Disabled by default for safety
    max_rows: 10

retry:
  max_retries: 3
  backoff_factor: 2
  retry_on_status: [500, 502, 503, 504]

output:
  save_format: json
  include_raw_requests: false
  include_screenshots: false

logging:
  level: INFO  # DEBUG, INFO, WARNING, ERROR
  file: data/logs/graytera.log
  console: true